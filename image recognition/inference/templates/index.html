<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Controle do Robô</title>
    <style>
        body { font-family: Arial, sans-serif; background:#f0f2f5; text-align:center; margin:0; }
        h1 { background:#4CAF50; color:#fff; padding:16px 0; margin:0; }
        .card { background:#fff; max-width:900px; margin:20px auto; padding:16px; border-radius:8px; }
        img { max-width:100%; border-radius:6px; border:1px solid #ddd; }
        button { padding:10px 18px; border-radius:6px; border:none; background:#4CAF50; color:#fff; cursor:pointer; }
        #status { margin-top:10px; font-weight:600; }
    </style>
</head>
<body>
    <h1>Controle do Robô</h1>
    <div class="card">
        <img id="cam" src="{{ url_for('video_feed') }}" alt="Feed">
        <div style="margin-top:12px;">
            <button id="btn" onclick="toggle()">Iniciar gravação</button>
        </div>
        <div id="status">Status: parado</div>
        <div id="info" style="margin-top:8px;"></div>
    </div>

    <script>
        let recording = false;
        async function toggle() {
            const res = await fetch('/toggle_recording', { method: 'POST' });
            const j = await res.json();
            if (res.ok) {
                recording = !recording;
                document.getElementById('btn').innerText = recording ? 'Parar gravação' : 'Iniciar gravação';
                document.getElementById('status').innerText = recording ? 'Status: Gravando' : 'Status: Parado';
            } else {
                alert('Erro: ' + JSON.stringify(j));
            }
        }

        // opcional: polla status para mostrar offset/vel
        setInterval(async () => {
            try {
                const r = await fetch('/status');
                const j = await r.json();
                document.getElementById('info').innerText = `Offset: ${j.offset.toFixed(1)} px | Speed: ${j.speed}`;
            } catch(e) {}
        }, 500);
    </script>
</body>
</html>
